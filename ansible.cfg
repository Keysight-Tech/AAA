[defaults]
# Inventory configuration - points to directory containing all inventory sources
inventory = ./inventory/

# Performance settings - adjust based on your infrastructure capacity
forks = 50                    # Increased for enterprise scale
callback_whitelist = profile_tasks, timer, yaml
stdout_callback = yaml        # Better formatted output
host_key_checking = False
retry_files_enabled = True
retry_files_save_path = ./retry/

# Logging configuration
log_path = ./ansible.log
no_log = False               # Set to True in production for security

# User and authentication settings
remote_user = ansible        # Standard service account for automation
# private_key_file = ~/.ssh/automation_key.pem  # Uncomment if using key-based auth

# Python interpreter settings
interpreter_python = auto_silent
ansible_python_interpreter = /usr/bin/python3

# Fact gathering optimization
gathering = smart
fact_caching = jsonfile
fact_caching_connection = ./facts_cache
fact_caching_timeout = 86400  # 24 hours

# Task execution settings
strategy = free              # Allows hosts to run independently
poll_interval = 15
timeout = 30
remote_tmp = /tmp/.ansible-${USER}/tmp

# Ansible Tower / AWX compatibility
show_custom_stats = True
display_args_to_stdout = False
error_on_undefined_vars = True

[ssh_connection]
# SSH optimization for better performance
ssh_args = -C -o ControlMaster=auto -o ControlPersist=300s -o PreferredAuthentications=publickey,password
control_path = /tmp/ansible-ssh-%%h-%%p-%%r
pipelining = True            # Reduces SSH operations needed
retries = 3

[persistent_connection]
# For network devices and API connections
connect_timeout = 60
command_timeout = 60
connect_retry_timeout = 30

[inventory]
# Enable multiple inventory plugins
enable_plugins = script, vmware_vm_inventory, constructed, yaml, ini, auto
# Uncomment below if using specific cloud providers in hybrid setup
# enable_plugins = script, vmware_vm_inventory, constructed, yaml, ini, auto, azure_rm, aws_ec2, gcp_compute

# Cache settings for dynamic inventory
cache = True
cache_plugin = jsonfile
cache_connection = ./inventory_cache
cache_timeout = 3600         # 1 hour cache for dynamic inventories
cache_prefix = ansible_inventory_

[callback_profile_tasks]
# Task profiling for performance optimization
task_output_limit = 100
sort_order = descending

# -----------------------------------------------------------------------------
# AUTHENTICATION OPTIONS
# -----------------------------------------------------------------------------
# For Ansible Tower:
# - Credentials are managed in Tower UI
# - Machine credentials for SSH/WinRM
# - Vault credentials for secrets
# - VMware credentials for dynamic inventory
#
# For CLI execution:
# 1. SSH Key Authentication (Recommended):
#    - Set private_key_file above
#    - Ensure key permissions are 600
#
# 2. Password Authentication:
#    ansible-playbook -i inventory/ playbook.yaml --ask-pass
#
# 3. Become (sudo) password if needed:
#    ansible-playbook -i inventory/ playbook.yaml --ask-become-pass
#
# 4. Using Ansible Vault for credentials:
#    ansible-playbook -i inventory/ playbook.yaml --ask-vault-pass
#    OR
#    ansible-playbook -i inventory/ playbook.yaml --vault-password-file ~/.vault_pass
#
# -----------------------------------------------------------------------------

# -----------------------------------------------------------------------------
# VMWARE / NSX-T SPECIFIC SETTINGS
# -----------------------------------------------------------------------------
# Set these environment variables or add to Tower credentials:
# export VMWARE_HOST=vcenter.example.com
# export VMWARE_USER=administrator@vsphere.local
# export VMWARE_PASSWORD=your_password
# export VMWARE_VALIDATE_CERTS=False
#
# For NSX-T API access:
# export NSX_MANAGER=nsxmgr.example.com
# export NSX_USERNAME=admin
# export NSX_PASSWORD=your_password
# -----------------------------------------------------------------------------

# -----------------------------------------------------------------------------
# WINDOWS SUPPORT
# -----------------------------------------------------------------------------
[winrm]
# WinRM settings for Windows hosts
transport = ntlm             # or kerberos, credssp, basic
server_cert_validation = ignore
operation_timeout_sec = 60
read_timeout_sec = 70

# -----------------------------------------------------------------------------
# PRIVILEGE ESCALATION
# -----------------------------------------------------------------------------
[privilege_escalation]
become = True
become_method = sudo
become_user = root
become_ask_pass = False      # Set to True if sudo requires password

# -----------------------------------------------------------------------------
# ANSIBLE TOWER CALLBACK
# -----------------------------------------------------------------------------
[callback_ansible_tower]
# These are automatically set when running from Tower
# host = https://tower.example.com
# verify_ssl = True
# job_id = set_by_tower
# host_config_key = set_by_tower

# -----------------------------------------------------------------------------
# GALAXY SETTINGS (for collections)
# -----------------------------------------------------------------------------
[galaxy]
server_list = automation_hub, galaxy

[galaxy_server.automation_hub]
# Configure if using Red Hat Automation Hub
# url = https://cloud.redhat.com/api/automation-hub/
# auth_url = https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token
# token = your_token_here

[galaxy_server.galaxy]
url = https://galaxy.ansible.com/
